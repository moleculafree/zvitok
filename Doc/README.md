> [!IMPORTANT]  
> Проект розповсюджується безкоштовно.  Якщо Ви бажаєте підтримати його розвиток, посилання [для донатів](https://send.monobank.ua/2MXeqRNEPw)
  
  
### Що вміє ZvitOkPlus ###

Все те що і звичайний ZvitOk 16.10.2023, плюс:
1. Корректна робота з сертифікатами що видані після 2023 року.
2. Запам'ятовує стан галочек, налаштування та шляхи при виборі ключів/підписів.
3. При імпорті звітів встановлення галочки головного звіту автоматично проставляє галочки на пакетних звітах.
4. Об'єднаний фільтр .dat,.pfx при додавані ключів в профілі организації.
5. Актуальність даних підпису - опціональна можливість отримувати всю інформацію про Підпис з сертифікату, а не з ключа. 
6. При додавані Підпису, якщо в сертифікаті користувача бракує інформації, вона зчитується з [INI файла](#Додавання-даних-в-Профіль-ЕЦП-за-відсутності-їх-в-сертифікаті)
7. Автоматичне визначення АЦСК при додавані Підпису. [АЦСК](#Автоматичне-визначення-АЦСК)
8. Можливість блокування файлу CACertificates.p7b від змін.
9. Додана підтримка ключів від "Вчасно Сервіс" та monobank.
10. Оновлені функції роботи з ключами і сертифікатами.
11. Змінено посилання на форум підтримки користувачів на актуальне.


### Файл Data\custom.ini ###
Файл містить перелік налаштувань які враховуються при роботі і для яких непотрібно змінювати код програми.  
**Цей файл оновлюється при кожній новій версії програми. Для власних налаштувань використовуйте файл private.ini**



### Файл Data\private.ini ###
> [!NOTE]  
> доступно, починаючи з версії 10.

Це пріоритетний файл власних перевизначених налаштувань. 
Фактично це копія custom.ini з вашими налаштуваннями та поточним станом елементів програми.
Ви можете змінювати цей файл на ваш розсуд. При інсталяції оновлень цей файл не змінюється.  
Програма буде считувати налаштування спочатку з файлу private.ini, а потім з custom.ini.  
**Важливо! Не впевнені у діях — не змінюйте цей файл.**  
Файл повинен мати ANSI кодування.


#### Перевизначення номерів службових сертифікатів ####
(номера сертифікатів вказувати у верхньому регістрі)
```
[DFS]
isuer=O=Державна податкова служба України;CN=КНЕДП ДПС;Serial=UA-43005393-0522;C=UA;L=Київ
serial=3FAA9288358EC00304000000995A2C005DDFE600

[DSS]
isuer=O=ТОВ "Центр сертифікації ключів "Україна";CN=КНЕДП ТОВ "Центр сертифікації ключів "Україна";Serial=UA-36865753-2101;C=UA;L=Київ
serial=2DB6710700000000000000000000000000000001
```

### Автоматичне визначення АЦСК ###
> [!NOTE]  
> доступно, починаючи з версії 10.

У списку «АЦСК, що видав сертифікати» доступний варіант «Автоматичне визначення». 
Обравши його, програма спробує самостійно знайти АЦСК і завантажити сертифікат. 
Майте на увазі: автоматичний пошук може бути повільнішим за ручний. 
Увімкнення в налаштуваннях галочки «Оптимізувати список АЦСК для автоматичного визначення» допоможе пришвидшити пошук.  


#### Додавання даних в Профіль ЕЦП за відсутності їх в сертифікаті ####
> [!IMPORTANT]  
> в Налаштуваннях програми має бути увімкнена галочка "Підтягувати відсутні дані в профіль з INI файлу"


acsk_url - замінити на адресу АЦСК що видав сертифікат, наприклад ca.monobank.ua  
або  
acsk_url-1234567890  де 1234567890 код ЄДРПОУ фізичної особи  

Якщо не знайдено дані в секції acsk_url-1234567890 буде проведено пошук в секції acsk_url

```
[acsk_url]

# Посада власника сертифіката, 
# текстовий рядок, наприклад ФІЗИЧНА ОСОБА або Директор
pszSubjTitle=

# Організація до якої належить, власник сертифіката, 
# текстовий рядок, наприклад ФІЗИЧНА ОСОБА або БСПНГУ "АЗОВ"
pszSubjOrg=

# Уточнене призначення ключів
# текстовий рядок, наприклад Єлектроний підпис
pszExtKeyUsages=

[acsk_url-1234567890]
pszSubjTitle=ФІЗИЧНА ОСОБА

```

#### Встановити атрибут "Лише читання" для файла CACertificates.p7b ####
```
[Certificates]
lock=1
```
