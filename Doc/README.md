> [!IMPORTANT]  
> Проект розповсюджується безкоштовно.  Якщо Ви бажаєте підтримати його розвиток, посилання [для донатів](https://send.monobank.ua/2MXeqRNEPw)
  

### Що вміє ZvitOkPlus ###

Все те що і звичайний ZvitOk 16.10.2023, плюс:
1. Корректна робота з сертифікатами що видані після 2023 року.
2. Запам'ятовує стан галочек, налаштування та шляхи при виборі ключів/підписів.
3. При імпорті звітів встановлення галочки головного звіту автоматично проставляє галочки на пакетних звітах.
4. Об'єднаний фільтр .dat,.pfx при додавані ключів в профілі организації.
5. Актуальність даних підпису - опціональна можливість отримувати всю інформацію про Підпис з сертифікату, а не з ключа. 
6. При додавані Підпису, якщо в сертифікаті користувача бракує інформації, вона зчитується з [INI файла](#Додавання-даних-в-Профіль-ЕЦП-за-відсутності-їх-в-сертифікаті)
7. Автоматичне визначення АЦСК при додавані Підпису. [АЦСК](#Автоматичне-визначення-АЦСК)
8. Можливість блокування файлу CACertificates.p7b від змін.
9. Можливість самостійно оновлювати спписок КНЕДП шляхом оновлення файлу \Certificates\CAs.json з сайту [Відновити систему](#Завантаження-списку-КНЕДП-з-файлу)
10. Додана підтримка ключів від "Вчасно Сервіс" та monobank.
11. Оновлені функції роботи з ключами і сертифікатами.
12. Магічна кнопка [Відновити систему](#Відновлення-стану-системних-файлів)
13. Змінено посилання на форум підтримки користувачів на актуальне.
14. Структура проекту ZvitOkPlus немає зворотньої сумісності зі старим ZvitOk <sup>але це не точно</sup>


### Завантаження списку КНЕДП з файлу ###
> [!NOTE]  
> доступно, починаючи з версії 10.

Якщо вам потрібно оновити список "прямо зараз", ви можете завантажити актуальні налаштування сумісних КНЕДП з сайту [Центральний засвідчувальний орган](https://czo.gov.ua/certificates) і розмістити його в папці ZvitOK\Certificates\CAs.json.

### Автоматичне визначення КНЕДП ###
> [!NOTE]  
> доступно, починаючи з версії 10.

При додавані підпису, в списку «КНЕДП, що видав сертифікати» доступний варіант «Автоматичне визначення». 
Обравши його, програма спробує самостійно знайти КНЕДП і завантажити сертифікат. 
Майте на увазі: автоматичний пошук може бути повільнішим за ручний. 
Увімкнення в налаштуваннях галочки «Оптимізувати список КНЕДП для автоматичного визначення» допоможе пришвидшити пошук.  

### Відновлення стану системних файлів ###
> [!NOTE]  
> доступно, починаючи з версії 10.

Якщо ви завантажили невдалий файл сертифікатів або список КНЕДП чи після редагування custom.ini програма перестала розуміти вас, зайдіть в Налаштування і натисніть кнопку **Відновити систему99. Після цього перезавантажте програму.

Ця процедура повертає початковий стан програми до "нове встановлення":
- видаляє файл \Data\custom.ini  
- видаляє файл \Certificates\Cas.json  
- перезаписує файл \Certificates\CACertificates.p7b  

Файли бази даних профілів не змінюються.

### Файл Data\System\default.ini ###
> [!NOTE]  
> доступно, починаючи з версії 10.

Файл містить перелік налаштувань які враховуються при роботі і для яких непотрібно змінювати код програми.  
**Цей файл оновлюється при кожній новій версії програми. Для власних налаштувань використовуйте файл \Data\custom.ini**

### Файл Data\custom.ini ###

Це пріоритетний файл власних перевизначених налаштувань. 
Фактично це копія default.ini але з вашими налаштуваннями та поточним станом елементів програми.
Ви можете змінювати цей файл на ваш розсуд. При інсталяції оновлень цей файл не змінюється.  
Програма буде считувати налаштування спочатку з файлу custom.ini, а потім з default.ini.  
**Важливо! Не впевнені у діях — не змінюйте цей файл.**  
Файл повинен мати ANSI кодування.

#### Перевизначення номерів службових сертифікатів ####
(номера сертифікатів вказувати у верхньому регістрі)
```
[DFS]
isuer=O=Державна податкова служба України;CN=КНЕДП ДПС;Serial=UA-43005393-0522;C=UA;L=Київ
serial=3FAA9288358EC00304000000995A2C005DDFE600

[DSS]
isuer=O=ТОВ "Центр сертифікації ключів "Україна";CN=КНЕДП ТОВ "Центр сертифікації ключів "Україна";Serial=UA-36865753-2101;C=UA;L=Київ
serial=2DB6710700000000000000000000000000000001
```

#### Додавання даних в Профіль ЕЦП за відсутності їх в сертифікаті ####
> [!IMPORTANT]  
> в Налаштуваннях програми має бути увімкнена галочка "Підтягувати відсутні дані в профіль з INI файлу"

Опис:  
acsk_url - замінити на адресу АЦСК що видав сертифікат, наприклад ca.monobank.ua  
або  
acsk_url-1234567890  де 1234567890 код ЄДРПОУ фізичної особи  

Якщо не знайдено дані в секції acsk_url-1234567890 буде проведено пошук в секції acsk_url

```
[acsk_url]

# Посада власника сертифіката, 
# текстовий рядок, наприклад ФІЗИЧНА ОСОБА або Директор
pszSubjTitle=

# Організація до якої належить, власник сертифіката, 
# текстовий рядок, наприклад ФІЗИЧНА ОСОБА або БСПНГУ "АЗОВ"
pszSubjOrg=

# Уточнене призначення ключів
# текстовий рядок, наприклад Єлектроний підпис
pszExtKeyUsages=

[acsk_url-1234567890]
pszSubjTitle=ФІЗИЧНА ОСОБА

```

#### Встановити атрибут "Лише читання" для файла CACertificates.p7b ####
```
[Certificates]
lock=1
```
