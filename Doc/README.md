> [!IMPORTANT]  
> Проект розповсюджується безкоштовно.  Якщо Ви бажаєте підтримати його розвиток, посилання [для донатів](https://send.monobank.ua/2MXeqRNEPw)
  

### Що вміє ZvitOkPlus ###

Все те що і звичайний ZvitOk 16.10.2023, плюс:
1. Оновлені функції роботи з ключами і сертифікатами.
2. Корректна робота з сертифікатами що видані після 2023 року.
3. Додана підтримка ключів "Вчасно Сервіс" та monobank.
4. Автоматичне визначення КНЕДП при додавані Підпису. [КНЕДП](#Автоматичне-визначення-КНЕДП)
5. Якщо в сертифікаті користувача бракує інформації, вона зчитується з [INI файла](#Додавання-даних-в-Профіль-ЕЦП-за-відсутності-їх-в-сертифікаті)
6. Автоматично зберігає стан опцій та шляхи до ключів/підписів.
7. Під час імпорту звітів, встановлення прапорця головного звіту автоматично позначає прапорці пакетних звітів.
8. Об'єднаний фільтр .dat,.pfx при додавані ключів в профілі организації.
9. Підтримка актуальності даних підпису - зчитування інформацію про Підпис з сертифікату, а не з ключа. 
10. Можливість самостійно керувати списком КНЕДП шляхом оновлення файлу \Certificates\CAs.json [CAs](#Завантаження-списку-КНЕДП-з-файлу)
11. Магічна кнопка [Відновити систему](#Відновлення-стану-системних-файлів)
12. ZvitOkPlus використовує новий формат збереження даних, тому якщо ви запустите старий ZvitOk, ви не побачите внесені зміни<sup>але є нюанс</sup>
13. Можливість блокування файлу CACertificates.p7b від змін.


### Завантаження списку КНЕДП з файлу ###
> [!NOTE]  
> доступно, починаючи з версії 10.

Якщо вам потрібно оновити список "прямо зараз", ви можете завантажити актуальні налаштування сумісних КНЕДП з сайту [Центральний засвідчувальний орган](https://czo.gov.ua/certificates) і розмістити/перезаписати його в папці ZvitOK\Certificates\CAs.json.

### Автоматичне визначення КНЕДП ###
> [!NOTE]  
> доступно, починаючи з версії 10.

При додавані підпису, в списку «КНЕДП, що видав сертифікати» доступний варіант «Автоматичне визначення». 
Обравши його, програма спробує самостійно знайти КНЕДП і завантажити сертифікат. 
Майте на увазі: автоматичний пошук може бути повільнішим за ручний. 
Увімкнення в налаштуваннях прапорця «Оптимізувати список КНЕДП для автоматичного визначення» допоможе пришвидшити пошук.  

### Відновлення стану системних файлів ###
> [!NOTE]  
> доступно, починаючи з версії 10.

Якщо ви завантажили невдалий файл сертифікатів або список КНЕДП чи після редагування custom.ini програма перестала розуміти вас, зайдіть в Налаштування і натисніть кнопку **Відновити систему**. Після цього перезавантажте програму.

Ця процедура повертає початковий стан програми до "нове встановлення":
- видаляє файл \Data\custom.ini  
- видаляє файл \Certificates\Cas.json  
- перезаписує файл \Certificates\CACertificates.p7b  

Файли бази даних профілів не змінюються.

### Файл Data\System\default.ini ###
> [!NOTE]  
> доступно, починаючи з версії 10.

Файл містить початковий перелік налаштувань які враховуються при роботі і для яких непотрібно змінювати код програми.  
**Цей файл оновлюється при кожній новій версії програми. Не змінюйте цей файл. Для власних налаштувань використовуйте файл \Data\custom.ini**

### Файл Data\custom.ini ###

Це пріоритетний файл власних перевизначених налаштувань користувача. 
Фактично це копія default.ini але з вашими налаштуваннями та поточним станом елементів програми.
Ви можете змінювати цей файл на ваш розсуд. При інсталяції нових оновлень цей файл не змінюється.  
Програма буде считувати налаштування спочатку з файлу \Data\custom.ini, а потім з \Data\System\default.ini.  
**Важливо! Не впевнені у діях — не змінюйте цей файл.**  
Файл повинен мати ANSI кодування.

#### Перевизначення номерів службових сертифікатів ####
(номера сертифікатів вказувати у верхньому регістрі)
```
[DFS]
isuer=O=Державна податкова служба України;CN=КНЕДП ДПС;Serial=UA-43005393-0522;C=UA;L=Київ
serial=3FAA9288358EC00304000000995A2C005DDFE600

[DSS]
isuer=O=ТОВ "Центр сертифікації ключів "Україна";CN=КНЕДП ТОВ "Центр сертифікації ключів "Україна";Serial=UA-36865753-2101;C=UA;L=Київ
serial=2DB6710700000000000000000000000000000001
```

#### Додавання даних в Профіль ЕЦП за відсутності їх в сертифікаті ####
> [!IMPORTANT]  
> в Налаштуваннях програми має бути увімкнено прапорець "Підтягувати відсутні дані в профіль з INI файлу"

Опис:  
[acsk_url] - де, acsk_url замінити на адресу КНЕДП що видав сертифікат, наприклад ca.monobank.ua  
або  
[acsk_url-1234567890]  де, 1234567890 код ЄДРПОУ фізичної особи  

Якщо не знайдено дані в секції [acsk_url-1234567890] буде проведено пошук в секції [acsk_url]

Приклад для monobank:
```
[ca.monobank.ua]

# Посада власника сертифіката, 
# текстовий рядок, наприклад ФІЗИЧНА ОСОБА або Директор
pszSubjTitle=ФІЗИЧНА ОСОБА

# Організація до якої належить, власник сертифіката, 
# текстовий рядок, наприклад ФІЗИЧНА ОСОБА або БСПНГУ "АЗОВ"
pszSubjOrg=ФІЗИЧНА ОСОБА

# Уточнене призначення ключів
# текстовий рядок, наприклад Єлектроний підпис
pszExtKeyUsages=

[ca.monobank.ua-1234567890]
pszSubjTitle=Директор

```

#### Встановити атрибут "Лише читання" для файла CACertificates.p7b ####
```
[Certificates]
lock=1
```
